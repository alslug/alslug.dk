digraph indmeldelse {
  { # Dine handlinger
    node [ shape=box style=filled fillcolor=yellow ];
    indtast                [label="Du indtaster\ndine informationer\nher på siden"];
    {
      node          [label="Du bekræfter din email\nved at klikke på linket\ni den tilsendte mail\n\nHusk at checke dit spam-filter"];
      confirm_email_nyt_medlem;
      confirm_email_add_mail;
      confirm_email_add_mobil;
    }
    confirm_sms            [label="Du reagerer på SMS'en"];
  }
  send_tilmelding        [shape=folder label="Data gemmes krypteret\npå serveren\n\nINGEN kan se dine informatiner før\ndu bekræfter din email.\n\n(Sikring mod robot-tilmeldinger)"];
  { # Server-aktiviteter
    node [shape=component];
    {
      node [label="Serveren sender\nen mail til dig hvor\ndu skal bekræfte\ndin tilmelding."];
      server_sender_emai_nyt_medlem;
      server_sender_email_add_email;
      server_sender_email_add_mobil;
    }
    server_sender_sms      [label="Serveren sender\nen SMS til dit\nmobil-nummer"];
    sms_confirmed          [label="Serveren registrerer\ndit response"];
  }
  { # Results
    node [shape=hexagon   style=filled fillcolor=green ];
    du_biver_medlem  [label="Du er nu blevet medlem"];
    mobile_ok        [label="Vi kan nu være sikre\npå at der er DIT\nmobil-nummer vi\nhar registreret."]; 
  }
  { # Valg
    node [shape=diamond];
    findes_allerede        [label="Kender vi\nallerde email\nog/eller eller\nmobil-nummer?"];
    hvad_findes_allerede   [label="Hvad\nfindes\nallerede"];
  }

  indtast -> send_tilmelding -> findes_allerede;
                                findes_allerede -> server_sender_emai_nyt_medlem [label="Nej"];
                                                   server_sender_emai_nyt_medlem -> confirm_email_nyt_medlem -> du_biver_medlem -> server_sender_sms -> confirm_sms -> sms_confirmed ->mobile_ok;
                                findes_allerede -> hvad_findes_allerede   [label="Ja"];
                                                   hvad_findes_allerede-> samme_member         [label="Begge"];
                                                                          samme_member -> already_member_email;
                                                   hvad_findes_allerede -> add_mobil_to_member [label="Mobil"];
                                                                           add_mobil_to_member -> server_sender_email_add_email  -> confirm_email_add_email -> x;
                                                   hvad_findes_allerede -> add_email_to_member [label="Email"];
                                                                           add_email_to_member -> server_sender_email_add_mobil  -> confirm_email_add_mobil -> y;
}
