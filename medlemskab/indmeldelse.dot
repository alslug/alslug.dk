digraph indmeldelse {
  { # Dine handlinger
    node [ shape=box style=filled fillcolor=yellow ];
    indtast         [label="Du indtaster\ndine informationer\nher på siden"];
    confirm_email   [label="Du bekræfter din email\nved at klikke på linket\ni den tilsendte mail\n\nHusk at checke dit spam-filter"];
    confirm_sms     [label="Du reagerer på SMS'en"];
  }
  send_tilmelding        [shape=folder label="Data gemmes krypteret \n på serveren \n \n INGEN kan se dine informatiner før \n du bekræfter din email."];
  { # Server-aktiviteter
    node [shape=component];
    server_sender_email [label="Serveren sender \n en mail til dig hvor \n du skal bekræfte \n din tilmelding."];
    server_sender_sms   [label="Serveren sender \n en SMS til dit \n mobil-nummer"];
    sms_confirmed       [label="Serveren registrerer \n dit response"];
  }
  { # Results
    node [shape=hexagon   style=filled fillcolor=green ];
    du_biver_medlem        [label="Du er nu blevet medlem."];
    allerede_medlem        [label="Du er allerede medlem."];
    mobile_ok              [label="Vi kan nu være sikre \n på at der er DIT \n mobil-nummer vi \n har registreret \n på dit medlemskab."]; 
    email_added            [label="Den nye \n ekstra email er \n registreret \n på dit medlemskab." ];
  }
  { # Valg
    node [shape=diamond];
    findes_allerede        [label="Kender vi \n allerde email \n og/eller eller \n mobil-nummer?"];
  }

  node [shape=point];

  indtast -> send_tilmelding -> findes_allerede;
  {
    edge [color=green];
                      findes_allerede ->                    server_sender_email [label="Nej"];
                                                            server_sender_email -> confirm_email -> du_biver_medlem -> server_sender_sms -> confirm_sms -> sms_confirmed  -> mobile_ok;
  }
  {
    edge [color=blue];
                      findes_allerede -> allerede_medlem                        [label="Email \n kendes"];
                                         allerede_medlem -> server_sender_email -> confirm_email ->                    server_sender_sms -> confirm_sms -> sms_confirmed -> mobile_ok;
  }
  {
    edge [color=magenta];
                      findes_allerede -> allerede_medlem                        [label="Mobil \n kendes"];
                                         allerede_medlem -> server_sender_email -> confirm_email ->                    server_sender_sms -> confirm_sms -> sms_confirmed -> email_added;
  }
  {
    edge [color=yellow];
                      findes_allerede- > allerede_medlem                        [label="Begge \n kendes \n\n samme \n medlem"];
                                         allerede_medlem -> samme_member        -> already_member_email;
  }
  {
    edge [color=red];
                      findes_allerede -> allerede_medlem                        [label="Begge \n kendes \n\n forskellige \n medlemmer"];
                                         allerede_medlem -> different_members   -> diffierent_members_email;
  }
}
