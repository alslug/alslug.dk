digraph xxx {
  {
    rank = same;
    wait_for_confirmation; check_for_remote_accept;
////////////////////////////////////////////////////////////////////////////////////////////
              wait_for_confirmation -> check_for_remote_accept [ dir=both ];           /////
////////////////////////////////////////////////////////////////////////////////////////////
  }
  same_session [ shape=record label="samesession|{<ja> ja|<nej> nej}" ];
  current_page [ style=filled fillcolor=green ];
  current_page ->
        enter_phone_number ->
              wait_for_confirmation ->
                    current_page;
////////////////////////////////////////////////////////////////////////////////////////////
        enter_phone_number -> sms_sendt [ style= dotted label="SMS med link"];         /////
////////////////////////////////////////////////////////////////////////////////////////////
  {
    edge [style=dotted];
////////////////////////////////////////////////////////////////////////////////////////////
        enter_phone_number -> memcached [ label="Data gemt i memcachd"]; /////
        memcached -> check_for_remote_accept [ label = "Hent data i memcached"];
        memcached -> login_accepted [ label = "Opdater data i memcached"];
////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////
        enter_phone_number -> session [ label="Data gemt i session"];    /////
////////////////////////////////////////////////////////////////////////////////////////////
}
  sms_sendt ->
        accept_login [ style=dotted label="Klik pÃ¥ link i SMS" ];
        accept_login ->
              login_accepted->
                    same_session;

                    same_session -> {ja,nej};
                          ja ->
                                current_page;
                          nej ->
                                gem_confirmed;
////////////////////////////////////////////////////////////////////////////////////////////
                                gem_confirmed ->                                       /////
                                      wait_for_confirmation [ style=dotted ];          /////
////////////////////////////////////////////////////////////////////////////////////////////
}
